<html>
    <head>
        <title>WebXR | BrilliantSole JavaScript SDK</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
        <script src="https://gftruj.github.io/hand.tracking.controls.extras/dist/aframe-hand-tracking-controls-extras.js"></script>
        <script src="../utils/aframe/fingertip-colliders-component.js"></script>
        <script src="../utils/aframe/fingertip-collider-target-component.js"></script>
        <script src="../utils/aframe/fingertip-button-component.js"></script>
        <script type="module" src="./script.js"></script>
    </head>

    <style>
        a-scene {
            height: calc(100% - 8rem);
            margin: auto;
            border-radius: 20px;
            overflow: hidden;
            border: solid black;
        }
    </style>

    <body>
        <nav>
            <a href="../../">home</a>
        </nav>

        <h1>WebXR | BrilliantSole JavaScript SDK</h1>

        <div>
            <label>webSocket url <input id="webSocketUrl" type="url" placeholder="localhost" /></label>
            <button id="toggleConnection">connect</button>
        </div>

        <div>
            <label> is scanning available? <input id="isScanningAvailable" type="checkbox" readonly disabled /> </label>
            <button id="toggleScan" disabled>scan</button>
        </div>

        <a-scene
            embedded
            xr-mode-ui="enabled: true; XRMode: ar"
            device-orientation-permission-ui="enabled: false"
            renderer="colorManagement: true;"
            webxr="optionalFeatures: hit-test;"
            ar-hit-test="target: #desktop;"
            obb-collider="showColliders: false;"
        >
            <a-assets>
                <a-asset-item id="insoleModel" src="../../assets/3d/leftInsole.glb"></a-asset-item>
            </a-assets>

            <a-entity
                class="left hand"
                hand-tracking-controls="hand: left;"
                hand-tracking-extras
                fingertip-colliders
                visible="true"
            ></a-entity>
            <a-entity
                class="right hand"
                hand-tracking-controls="hand: right;"
                hand-tracking-extras
                fingertip-colliders
                visible="true"
            ></a-entity>

            <template id="insoleMotionTemplate">
                <a-entity class="insole motion">
                    <a-entity class="positionOffset">
                        <a-entity class="rotationOffset">
                            <a-entity class="model" gltf-model="#insoleModel"></a-entity>
                        </a-entity>
                    </a-entity>
                </a-entity>
            </template>

            <template id="insolePressureTemplate">
                <a-entity class="insole pressure"></a-entity>
            </template>

            <a-entity id="desktop" hide-on-enter-ar position="0 1 -0.75">
                <a-entity
                    class="toggleARHitTest"
                    position="-0.4 0 0"
                    fingertip-button="hands: left; fingers: index; text: move;"
                ></a-entity>

                <a-entity
                    class="toggleSetWebSocketUrl"
                    position="0.4 0 0.1"
                    fingertip-button="hands: right; fingers: index; text: localhost; subtitle: url;"
                ></a-entity>

                <a-entity
                    class="toggleConnection"
                    position="0.4 0 0"
                    fingertip-button="hands: right; fingers: index; text: connect;"
                ></a-entity>

                <a-entity
                    class="toggleScan"
                    position="0.4 0 -0.1"
                    fingertip-button="hands: right; fingers: index; text: scan; disabled: true;"
                ></a-entity>
            </a-entity>
        </a-scene>
    </body>
</html>
